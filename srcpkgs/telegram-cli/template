# Template file for 'telegram-cli'
pkgname=telegram-cli
version=20200106
revision=1
build_style=gnu-configure
hostmakedepends="lua-devel libevent-devel jansson-devel zlib-devel libconfig-devel readline-devel libressl-devel libcrypto45"
makedepends="lua-devel libevent-devel jansson-devel zlib-devel libconfig-devel readline-devel libressl-devel libcrypto45"
short_desc="Command-line interface for Telegram. Uses readline interface"
maintainer="Marco Bertoni <marco.bertoni.bologna@gmail.com>"
license="GPL-2.0-only"
homepage="https://github.com/kenorb-contrib/tg"
_tglversion=20190203
distfiles="https://github.com/kenorb-contrib/tg/archive/${version}.tar.gz>tg-${version}.tar.gz https://github.com/kenorb-contrib/tgl/archive/${_tglversion}.tar.gz>tgl-${_tglversion}.tar.gz"
checksum="824504804e8c0bb20943d765ba54feaacda7b2ec34735da0cfe5d5e61348d519 178e443938a89c9aa771fe7a25b36315840915bff8f6744ab298f36f88540a32"

do_extract() {
	srcdir="$XBPS_SRCDISTDIR/$pkgname-$version"
	tar -x --no-same-permissions --no-same-owner -f $srcdir/tg-${version}.tar.gz -C $wrksrc --strip-components 1
	tar -x --no-same-permissions --no-same-owner -f $srcdir/tgl-${_tglversion}.tar.gz -C $wrksrc/tgl --strip-components 1
}

######
# config and make stuff inside tgl subdir, create host executables
#####

do_install() {
	cd ${wrksrc}
	vbin bin/telegram-cli
	vman debian/telegram-cli.8
	vconf tg-server.pub server.pub
}
